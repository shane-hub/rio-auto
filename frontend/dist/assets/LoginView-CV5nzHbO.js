import{d as D,u as N,r as w,c as F,a as M,b as r,e,w as n,E as R,f as U,g as l,t as d,h as z,i as f,j,k as q,l as x,m as A,n as J,o as O,p as P,q as T,s as G,v,x as h,_ as H}from"./index-BGhkaV9i.js";/* empty css                   */const K={class:"login-container"},Q={class:"lang-switch"},W={class:"el-dropdown-link"},X={class:"links"},Y=D({__name:"LoginView",setup(Z){const E=T(),{t:m,locale:p}=N(),t=w({username:"",password:""}),u=w(!1),k=F(()=>p.value==="zh"?"中文":"English"),V=o=>{p.value=o,localStorage.setItem("language",o)},y=async()=>{u.value=!0;try{const o=new URLSearchParams;o.append("username",t.value.username),o.append("password",t.value.password);const a=await v.post("/auth/token",o);localStorage.setItem("token",a.access_token);const s=await v.get("/auth/me");localStorage.setItem("user",JSON.stringify(s)),h.success(m("common.welcome")+" "+s.username),E.push("/")}catch{h.error(m("login.loginFailed"))}finally{u.value=!1}};return(o,a)=>{const s=f("arrow-down"),I=z,_=q,S=j,b=R,g=O,c=J,C=P,L=f("router-link"),B=x,$=U;return G(),M("div",K,[r("div",Q,[e(b,{onCommand:V,style:{cursor:"pointer"}},{dropdown:n(()=>[e(S,null,{default:n(()=>[e(_,{command:"zh"},{default:n(()=>[...a[2]||(a[2]=[l("中文",-1)])]),_:1}),e(_,{command:"en"},{default:n(()=>[...a[3]||(a[3]=[l("English",-1)])]),_:1})]),_:1})]),default:n(()=>[r("span",W,[l(d(k.value)+" ",1),e(I,{class:"el-icon--right"},{default:n(()=>[e(s)]),_:1})])]),_:1})]),e($,{class:"login-card"},{default:n(()=>[r("h2",null,d(o.$t("login.title")),1),e(B,{model:t.value,onSubmit:A(y,["prevent"])},{default:n(()=>[e(c,null,{default:n(()=>[e(g,{modelValue:t.value.username,"onUpdate:modelValue":a[0]||(a[0]=i=>t.value.username=i),placeholder:o.$t("login.username")},null,8,["modelValue","placeholder"])]),_:1}),e(c,null,{default:n(()=>[e(g,{modelValue:t.value.password,"onUpdate:modelValue":a[1]||(a[1]=i=>t.value.password=i),type:"password",placeholder:o.$t("login.password")},null,8,["modelValue","placeholder"])]),_:1}),e(c,null,{default:n(()=>[e(C,{type:"primary","native-type":"submit",loading:u.value,block:""},{default:n(()=>[l(d(o.$t("login.loginBtn")),1)]),_:1},8,["loading"])]),_:1}),r("div",X,[e(L,{to:"/register"},{default:n(()=>[l(d(o.$t("login.createAccount")),1)]),_:1})])]),_:1},8,["model"])]),_:1})])}}}),ne=H(Y,[["__scopeId","data-v-3e6ccbf6"]]);export{ne as default};
